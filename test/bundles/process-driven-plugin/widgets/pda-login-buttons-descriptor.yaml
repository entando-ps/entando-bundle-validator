code: pda_login_buttons
titles:
  en: PDA Login Buttons
  it: PDA Login Buttons
group: free
customUi: "<#assign wp=JspTaglibs[\"/aps-core\"]>\r\n\r\n<#if (Session.currentUser != \"guest\")>\r\n<div class=\"btn-group login-group\">\r\n    <button type=\"button\" class=\"btn login dropdown-toggle px-3 user-button\" data-toggle=\"dropdown\" aria-haspopup=\"true\"  aria-expanded=\"false\">\r\n        ${Session.currentUser} <span class=\"sr-only\">${Session.currentUser}</span>\r\n    </button>\r\n    <div class=\"dropdown-menu login-drop\" style=\"right: 0; left: auto; margin-top: 4px\">\r\n\r\n        <@wp.ifauthorized permission=\"enterBackend\">\r\n        <a class=\"dropdown-item\" href=\"<@wp.info key=\"systemParam\" paramName=\"applicationBaseURL\" />do/main.action?request_locale=<@wp.info key=\"currentLang\" />\">\r\n           <@wp.i18n key=\"ESLF_ADMINISTRATION\" />\r\n        </a>\r\n    \r\n    <a class=\"dropdown-item\" href=\"<@wp.url page=\"homepage\" />\" >\r\n       Back to application\r\n    </a>\r\n        </@wp.ifauthorized>\r\n        <a class=\"dropdown-item\"  href=\"<@wp.info key=\"systemParam\" paramName=\"applicationBaseURL\" />do/logout.action\">       \r\n         <@wp.i18n key=\"ESLF_SIGNOUT\" />\r\n        </a>\r\n\r\n<@wp.pageWithWidget var=\"editProfilePageVar\" widgetTypeCode=\"userprofile_editCurrentUser\" />\r\n<#if (editProfilePageVar??) >\r\n<a class=\"dropdown-item\" href=\"<@wp.url page=\"${editProfilePageVar.code}\" />\" ><@wp.i18n key=\"ESLF_PROFILE_CONFIGURATION\" /></a>\r\n</#if>\r\n</div>\r\n</div>\r\n\r\n<a class=\"dropdown-item d-none d-sm-block d-md-none\"\r\n   ${Session.currentUser} <span class=\"sr-only\">${Session.currentUser}</span>\r\n</a>\r\n\r\n<script>\r\n(function() {\r\n   console.log( \"ready!\" );\r\n\r\nwindow.addEventListener('click', function () {\r\n         document.getElementsByClassName('dropdown-menu')[0].style.display = 'none';\r\n})\r\n\r\ndocument.getElementsByClassName('user-button')[0].addEventListener('click', function(event){\r\n    event.stopPropagation();\r\n    document.getElementsByClassName('dropdown-menu')[0].style.display = 'block';\r\n});\r\n\r\ndocument.getElementsByClassName('dropdown-menu')[0].addEventListener('click', function(event){\r\n    event.stopPropagation();\r\n});\r\n\r\n})();\r\n</script>\r\n\r\n<#else>\r\n<script>\r\nfunction login () {  \r\n  window.entando.keycloak.login();\r\n  location.href = '<@wp.info key=\"systemParam\" paramName=\"applicationBaseURL\" />do/login?redirectTo=<@wp.url page=\"homepage\"/>';\r\n}\r\n</script>\r\n<script>\r\nwindow.addEventListener(\"user.form.login\", (evt) => {\r\n  if(evt.detail.payload){\r\n    login();\r\n  }\r\n});\r\n</script>\r\n\r\n<div class=\"btn-group login-drop\">\r\n    <button type=\"button\" class=\"btn login dropdown-toggle mr-3\"  onclick=\"login()\" >\r\n        <@wp.i18n key=\"ESLF_SIGNIN\" />\r\n    </button>\r\n    <a class=\"btn sign-up \" href=\"<@wp.url page=\"sign_up\" />\" >\r\n       <@wp.i18n key=\"SIGN_UP\" />\r\n    </a>\r\n\r\n</div>\r\n</#if>"
